---
import Layout from '../layouts/Layout.astro';
import "../styles/global.css";
---

<Layout>
    <div class="bg">
		<form method="post" class="initial_forms">
			<h1 class="initial_titles">Inicio de sesion</h1>
			<input class="initial_inputs" name="email" type="text" placeholder="Correo Universitario (@unet.edu.ve)">
			<input class="initial_inputs" name="password" type="password" placeholder="ContraseÃ±a">
			<button class="initial_buttons" type="submit">Iniciar Sesion</button>
      		<a class="link_create" href="/create-account">No tienes una cuenta?, REGISTRATE</a>
        </form>
	</div>
</Layout>

<script>
const form = document.querySelector('form');

if (form) { 
    form.addEventListener('submit', async (event) => {
        event.preventDefault();

        const formData = new FormData(form)
        const data = new URLSearchParams();
        for (const pair of formData) {
            data.append(pair[0], pair[1].toString());
        }

        try {
            const response = await fetch(new URL('http://localhost:8081/login'), {
                method: 'POST',
                credentials: 'include',
                body: data,
            });

            if (response.ok) {
                form.reset();
                window.location.href = '/home';
            } else {
                throw new Error('Error al enviar el formulario');
            }
        } catch {
        }
    });
}
</script>
